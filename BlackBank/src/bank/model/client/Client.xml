<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="Client">
  <typeAlias alias="Client" type="bank.model.client.ClientBean"/>
  <resultMap id="ClientResult" class="Client">
    <result property="cltNum" column="cltNum"/>
    <result property="cltName" column="cltName"/> 
    <result property="cltRrn" column="cltRrn"/>
    <result property="cltTel" column="cltTel"/>
    <result property="cltCel" column="cltCel"/>
    <result property="cltAddr" column="cltAddr"/>
    <result property="cltEmail" column="cltEmail"/>
  </resultMap>
  
  <!-- 네임스페이스가 적용된 xml id값 호출방법 : Client.getAllRetrieveClts-->
  <select id="getAllRetrieveClts" resultMap="ClientResult">
    select * from client ORDER BY cltNum asc
  </select>
  
  <select id="getRetrieveClt" parameterClass="java.lang.String" resultClass="Client">
    select
      cltNum as cltNum,
      cltName as cltName,
      cltRrn as cltRrn,
      cltTel as cltTel,
      cltCel as cltCel,
      cltAddr as cltAddr,
      cltEmail as cltEmail    
    from client
    where cltRrn = #cltRrn#    
  </select>
  
  <select id="getDuplicationClt" parameterClass="java.lang.String" resultClass="Client">
    select
      cltNum as cltNum,
      cltRrn as cltRrn
    from client
    where cltRrn = #cltRrn#    
  </select>
  
  <update id="setRegisterClt" parameterClass="Client">
    insert into client (
      cltNum,
      cltName,
      cltRrn,
      cltTel,
      cltCel,
      cltAddr,
      cltEmail
    )
    values (
      seq_client.nextval, #cltName#, #cltRrn#, #cltTel#, #cltCel#, #cltAddr#, #cltEmail#
    )    
  </update>
  
  <update id="setModifyClt" parameterClass="Client">
    update client set
      cltTel= #cltTel#, 
      cltCel= #cltCel#,
      cltAddr= #cltAddr#,
      cltEmail= #cltEmail#           
    where
      cltRrn = #cltRrn#
  </update>
  
  <delete id="setRemoveClt" parameterClass="java.lang.String">
    delete from client where cltRrn = #cltRrn#
  </delete> 
  
  <select id="getCountClts" resultClass="java.lang.Integer">
    select count(*) from client
  </select>
  
  <select id="getPageClt" parameterClass="java.lang.Integer" resultMap="ClientResult">
    select
      cltNum as cltNum,
      cltName as cltName,
      cltRrn as cltRrn,
      cltTel as cltTel,
      cltCel as cltCel,
      cltAddr as cltAddr,
      cltEmail as cltEmail    
    from (select
    		/*index_desc(client, client_clitnum_pk)*/
    		cltNum as cltNum,
      		cltName as cltName,
      		cltRrn as cltRrn,
      		cltTel as cltTel,
      		cltCel as cltCel,
      		cltAddr as cltAddr,
      		cltEmail as cltEmail,
      		ceil(rownum/7) as page
      	  from client)
    where page = #page#   
  </select> 
  
</sqlMap>